import{d as Y,c as T,a as A,g as D,b as L,i as l,e as z,f as G,h as g,j as Q,r as j,s as w,t as J,o as F,u as X,k as N}from"./web.BBIpouoX.js";import{r as Z,b as q}from"./resolveExamTables.DN-B9pzp.js";import{l as ee}from"./adapter.qPMjiGBV.js";import{c as te}from"./preload-helper.dLw7uZYB.js";import{S as R}from"./SimpleButton.C-Murjw0.js";import"./youtube.CdAUXvhk.js";var ie=J('<div><h2></h2><p><a target=_blank></a></p><div class="relative flex flex-col gap-2"><div class="overflow-y-scroll h-96"><!$><!/><!$><!/><table><thead><tr><th>Execution</th><th>Attack</th><th>Defence</th><th>Direction</th><th>Video</th><th>dirty</th></tr></thead><tbody></tbody></table></div><div>'),ae=J("<tr><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2>"),de=J('<div class="border p-2 gap-2 flex flex-col"><div class="grid gap-2 grid-cols-3 items-center"><label>ID:</label><div class=col-span-2></div><label>Name:</label><div class=col-span-2></div><label>Start (Press "S" to use current time):</label><input class="w-16 border p-2"type=text min=0><input type=range min=0><label>End (Press "E" to use current time):</label><input class="w-16 border p-2"type=text min=0><input type=range min=0></div><div class=flex-1>');const ue=e=>{const[s,c]=T(null),[o,m]=T(JSON.parse(localStorage.getItem(`videoPack-${e.videoPack.metadata.name}`)??"{}"));A(()=>{localStorage.setItem(`videoPack-${e.videoPack.metadata.name}`,JSON.stringify(o()))});const d=Z([e.videoPack.videos],(a,r)=>({...a,videos:r})).flatMap(({videos:a,...r})=>a.map(t=>({...r,video:t})));function _(a){m(r=>({...r,[a.video.id]:a}))}function C(a){c(o()[a.video.id]??a)}async function $(){const a=d.map(n=>o()[n.video.id]??n),r=q(a,(n,S)=>S?[...S,n.video]:[n.video]),t={...e.videoPack,videos:r};await navigator.clipboard.writeText(JSON.stringify(t,null,2)),alert("Copied to clipboard")}return(()=>{var a=D(ie),r=a.firstChild,t=r.nextSibling,n=t.firstChild,S=t.nextSibling,v=S.firstChild,V=v.firstChild,[y,O]=L(V.nextSibling),f=y.nextSibling,[u,B]=L(f.nextSibling),x=u.nextSibling,h=x.firstChild,E=h.nextSibling,P=v.nextSibling;return l(r,()=>e.videoPack.metadata.name),l(n,()=>e.videoPack.metadata.source),l(v,z(R,{label:"Clear all",onClick:()=>m({})}),y,O),l(v,z(R,{label:"Export",onClick:$}),u,B),l(E,()=>d.map((i,I)=>(()=>{var b=D(ae),k=b.firstChild,p=k.nextSibling,K=p.nextSibling,M=K.nextSibling,H=M.nextSibling,W=H.nextSibling;return b.$$click=()=>C(o()[i.video.id]??i),l(k,()=>i.execution),l(p,()=>i.attack),l(K,()=>i.defence),l(M,()=>i.direction),l(H,()=>i.video.title),l(W,()=>o()[i.video.id]!=null?"x":""),g(()=>Q(b,te(s()?.video.id===i.video.id?"bg-primary-light":I%2===0&&"bg-secondary-lightest","cursor-pointer"))),j(),b})())),l(P,(()=>{var i=G(()=>!!s());return()=>i()&&z(ne,{get video(){return s()},onChange:_})})()),g(()=>w(n,"href",e.videoPack.metadata.source)),a})()},ne=e=>{const[s,c]=T(0),[o,m]=T(e.video.video.durationSeconds);let d=null,_=null;async function C(t){const n=document.createElement("div");t.append(n),d=await ee(n),_=new ResizeObserver(()=>{d?.setSize(t.clientWidth,t.clientHeight)}),_.observe(t),await d?.loadVideoById(e.video.video.videoId,s(),o()),await d?.playVideo()}A(()=>{c(e.video.video.startSeconds??0),m(e.video.video.endSeconds??e.video.video.durationSeconds)});async function $(){await d?.loadVideoById(e.video.video.videoId,s(),o()),await d?.playVideo(),e.onChange({...e.video,video:{...e.video.video,startSeconds:s(),endSeconds:o()}})}F(()=>{d?.destroy(),_?.disconnect()}),U("KeyS",async()=>{d&&(c(await d.getCurrentTime()),$())}),U("KeyE",async()=>{d&&(m(await d.getCurrentTime()),$())}),A(()=>{e.video.video;const t=e.video.video;d?.loadVideoById(t.videoId,t.startSeconds,t.endSeconds)});function a(t){c(Number(t.target.value)),$()}function r(t){m(Number(t.target.value)),$()}return(()=>{var t=D(de),n=t.firstChild,S=n.firstChild,v=S.nextSibling,V=v.nextSibling,y=V.nextSibling,O=y.nextSibling,f=O.nextSibling,u=f.nextSibling,B=u.nextSibling,x=B.nextSibling,h=x.nextSibling,E=n.nextSibling;l(v,()=>e.video.video.videoId),l(y,()=>e.video.video.title),f.$$input=a,u.$$input=a,x.$$input=r,h.$$input=r;var P=C;return typeof P=="function"?X(P,E):C=E,g(i=>{var I=e.video.video.durationSeconds,b=e.video.video.durationSeconds,k=e.video.video.durationSeconds,p=e.video?.video.durationSeconds;return I!==i.e&&w(f,"max",i.e=I),b!==i.t&&w(u,"max",i.t=b),k!==i.a&&w(x,"max",i.a=k),p!==i.o&&w(h,"max",i.o=p),i},{e:void 0,t:void 0,a:void 0,o:void 0}),g(()=>N(f,"value",s())),g(()=>N(u,"value",s())),g(()=>N(x,"value",o())),g(()=>N(h,"value",o())),j(),t})()};function U(e,s){const c=o=>{o.code===e&&s()};window.addEventListener("keydown",c),F(()=>window.removeEventListener("keydown",c))}Y(["click","input"]);export{ue as VideoPackEditor};

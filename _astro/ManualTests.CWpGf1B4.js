import{d as T,b as L,q as M,g as p,a as g,i,e as _,r as j,t as u,c as x}from"./web.BO7jKKnc.js";import{F as O}from"./ForEntries.BbMJkD_v.js";const D="/_astro/playArrayBuffer.fixture.D9jk8p3Y.mp3";function F(){let e=null,r=null;return{promise:new Promise((n,a)=>{e=n,r=a}),resolve:e,reject:r}}function N(e){const r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(new Uint8Array(e)),r}const R=async(e,r={})=>{const l=U(),{resolve:n,promise:a}=F(),t=l.createBufferSource(),o=N(e);if(t.buffer=await l.decodeAudioData(o),t.connect(l.destination),!r.abortSignal?.aborted)return r.abortSignal?.addEventListener("abort",()=>t.stop()),t.start(),t.addEventListener("ended",()=>n()),a};let $=null;function U(){return $==null&&($=new AudioContext),$}var q=u('<div><ol><li>Press the play button<ul><li>The text "ai hamni katate dori" should be played</li><li>During playback, "playing" should be shownw</li><li>After playback, "playing" should disappear</li></ul></li><li>Press "play" and then "stop"<ul><li>The text "ai hamni katate dori" should be played</li><li>On pressing stop, the playback should be stopped</li></ul></li><li>Press "play" multiple times, before the playback is finished"<ul><li>The text "ai hamni katate dori" should be played</li><li>On pressing "play" again, the previous playback should be stopped</li></ul></li></ol><div class="flex gap-2 items-center py-2"><!$><!/><!$><!/><button class="border-primary border bg-primary-light p-2 rounded"></button><button class="border-primary border bg-primary-light p-2 rounded">Stop</button><div>'),H=u("<p>Error while loading mp3: <!$><!/>"),W=u("<p>Loading mp3");async function Y(){return await(await fetch(D)).arrayBuffer()}const z=()=>{let e=new AbortController;const[r,l]=L(0),n=()=>{e.abort(),e=new AbortController},a=async o=>{n(),l(s=>s+1),await R(o,{abortSignal:e.signal}),l(s=>s-1)},[t]=M(Y);return(()=>{var o=p(q),s=o.firstChild,c=s.nextSibling,v=c.firstChild,[f,S]=g(v.nextSibling),w=f.nextSibling,[h,k]=g(w.nextSibling),d=h.nextSibling,m=d.nextSibling,A=m.nextSibling;return i(c,(()=>{var b=_(()=>!!t.error);return()=>b()&&(()=>{var y=p(H),C=y.firstChild,B=C.nextSibling,[E,P]=g(B.nextSibling);return i(y,()=>t.error,E,P),y})()})(),f,S),i(c,(()=>{var b=_(()=>!!t.loading);return()=>b()&&p(W)})(),h,k),d.$$click=()=>a(t()),i(d,()=>t.loading?"Loading...":"Play"),m.$$click=()=>n(),i(A,()=>r()>0&&"Playing"),j(),o})()};T(["click"]);var G=u("<div>"),I=u("<div><h1></h1><div>");const J=Object.assign({"/src/adapters/playArrayBuffer/playArrayBuffer.manual-test.tsx":z}),V=()=>(()=>{var e=p(G);return i(e,x(O,{object:J,children:(r,l)=>(()=>{var n=p(I),a=n.firstChild,t=a.nextSibling;return i(a,r),i(t,x(l,{})),n})()})),e})();export{V as ManualTests};

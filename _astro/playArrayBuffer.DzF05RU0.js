import{d as E,b as L,m as M,g as b,a as g,i as s,e as _,r as T,t as f}from"./web.B86Gv6As.js";const D="/_astro/playArrayBuffer.fixture.D9jk8p3Y.mp3";function O(){let e=null,l=null;return{promise:new Promise((r,a)=>{e=r,l=a}),resolve:e,reject:l}}function j(e){const l=new ArrayBuffer(e.byteLength);return new Uint8Array(l).set(new Uint8Array(e)),l}const N=async(e,l={})=>{const n=R(),{resolve:r,promise:a}=O(),t=n.createBufferSource(),i=j(e);if(t.buffer=await n.decodeAudioData(i),t.connect(n.destination),!l.abortSignal?.aborted)return l.abortSignal?.addEventListener("abort",()=>t.stop()),t.start(),t.addEventListener("ended",()=>r()),a};let y=null;function R(){return y==null&&(y=new AudioContext),y}var U=f('<div><ol><li>Press the play button<ul><li>The text "ai hamni katate dori" should be played</li><li>During playback, "playing" should be shownw</li><li>After playback, "playing" should disappear</li></ul></li><li>Press "play" and then "stop"<ul><li>The text "ai hamni katate dori" should be played</li><li>On pressing stop, the playback should be stopped</li></ul></li><li>Press "play" multiple times, before the playback is finished"<ul><li>The text "ai hamni katate dori" should be played</li><li>On pressing "play" again, the previous playback should be stopped</li></ul></li></ol><div class="d-flex gap-2 align-items-center"><!$><!/><!$><!/><button></button><button>Stop</button><div>'),H=f("<p>Error while loading mp3: <!$><!/>"),W=f("<p>Loading mp3");async function Y(){return await(await fetch(D)).arrayBuffer()}const z=()=>{let e=new AbortController;const[l,n]=L(0),r=()=>{e.abort(),e=new AbortController},a=async i=>{r(),n(o=>o+1),await N(i,{abortSignal:e.signal}),n(o=>o-1)},[t]=M(Y);return(()=>{var i=b(U),o=i.firstChild,u=o.nextSibling,x=u.firstChild,[$,v]=g(x.nextSibling),S=$.nextSibling,[h,w]=g(S.nextSibling),p=h.nextSibling,m=p.nextSibling,k=m.nextSibling;return s(u,(()=>{var c=_(()=>!!t.error);return()=>c()&&(()=>{var d=b(H),A=d.firstChild,C=A.nextSibling,[P,B]=g(C.nextSibling);return s(d,()=>t.error,P,B),d})()})(),$,v),s(u,(()=>{var c=_(()=>!!t.loading);return()=>c()&&b(W)})(),h,w),p.$$click=()=>a(t()),s(p,()=>t.loading?"Loading...":"Play"),m.$$click=()=>r(),s(k,()=>l()>0&&"Playing"),T(),i})()};E(["click"]);export{z as ManualTest};

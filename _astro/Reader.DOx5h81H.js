const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/YoutubePlayer.CacvYtOJ.js","_astro/web.CyVLF7YK.js","_astro/index.browser.DakfiRJi.js","_astro/video_library.C52Xc_My.js","_astro/delay.2S0BUUWF.js","_astro/_commonjsHelpers.BosuxZz1.js","_astro/techniqueStore.Q_mPk7YU.js","_astro/playArrayBuffer.DyJiE7Ye.js"])))=>i.map(i=>d[i]);
import{S as R,t as L,c as U,a as V,p as D,y as H,_ as Y}from"./techniqueStore.Q_mPk7YU.js";import{g,j as P,r as m,t as y,h as w,b,i as h,c as s,F as M,d as C,e as S,s as T,a as _,k as j,u as O,f as B,v as W,l as G,p as J,S as K,w as Q}from"./web.CyVLF7YK.js";import{c as I,d as X,S as A,C as Z}from"./index.browser.DakfiRJi.js";import{p as ee,D as te}from"./playArrayBuffer.DyJiE7Ye.js";var ne=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="M8 5v14l11-7z">');const ae=(e={})=>(()=>{var t=g(ne);return P(t,e,!0,!0),m(),t})();var re=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="M6 6h12v12H6z">');const ie=(e={})=>(()=>{var t=g(re);return P(t,e,!0,!0),m(),t})();var le=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="m6 18 8.5-6L6 6zM16 6v12h2V6z">');const se=(e={})=>(()=>{var t=g(le);return P(t,e,!0,!0),m(),t})();var oe=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="M6 6h2v12H6zm3.5 6 8.5 6V6z">');const ce=(e={})=>(()=>{var t=g(oe);return P(t,e,!0,!0),m(),t})();var ue=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="M19.03 3.56c-1.67-1.39-3.74-2.3-6.03-2.51v2.01c1.73.19 3.31.88 4.61 1.92zM11 3.06V1.05c-2.29.2-4.36 1.12-6.03 2.51l1.42 1.42A8.93 8.93 0 0 1 11 3.06M4.98 6.39 3.56 4.97C2.17 6.64 1.26 8.71 1.05 11h2.01c.19-1.73.88-3.31 1.92-4.61M20.94 11h2.01c-.21-2.29-1.12-4.36-2.51-6.03l-1.42 1.42A8.93 8.93 0 0 1 20.94 11M7 12l3.44 1.56L12 17l1.56-3.44L17 12l-3.44-1.56L12 7l-1.56 3.44z"></path><path d="M12 21a8.96 8.96 0 0 1-7.46-4H7v-2H1v6h2v-2.7c1.99 2.84 5.27 4.7 9 4.7 4.87 0 9-3.17 10.44-7.56l-1.96-.45C19.25 18.48 15.92 21 12 21">');const de=(e={})=>(()=>{var t=g(ue);return P(t,e,!0,!0),m(),t})();var he=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z"></path><path d="M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83">');const ge=(e={})=>(()=>{var t=g(he);return P(t,e,!0,!0),m(),t})();var ye=y('<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"></path><path d="M15.97 11.03C14.87 9.79 13.28 9 11.5 9c-2.82 0-5.18 1.95-5.82 4.56l.96.32C7.15 11.66 9.13 10 11.5 10c1.51 0 2.85.68 3.76 1.74L13 14h5V9z">');const ve=(e={})=>(()=>{var t=g(ye);return P(t,e,!0,!0),m(),t})(),xe=["execution","attack","defence","direction"];function E(e){return`${e.execution} ${e.attack} ${e.defence} ${e.direction}`.replace(/\W/g,"_")}const fe=["execution","attack","defence"];function F(e,t){const n=e.direction===R?fe:xe;return t==null?n:e.execution!==t.execution?n.slice(0):e.attack!==t.attack?n.slice(1):e.defence!==t.defence?n.slice(2):e.direction!==t.direction?n.slice(3):n}function*be(e){let t;for(const n of e){const a=F(n,t);yield{id:E(n),execution:{value:n.execution,relevant:a.includes("execution")},attack:{value:n.attack,relevant:a.includes("attack")},defence:{value:n.defence,relevant:a.includes("defence")},direction:{value:n.direction,relevant:a.includes("direction")}},t=n}}var $e=y('<ul><!$><!/><a class="border-info border bg-info-lightest h-32 flex flex-col items-center justify-center gap-4 text-black "><span></span><span>'),we=y('<div class="absolute flex items-center top-0 right-0 rounded bg-primary-dark font-bold text-white p-1 origin-top-right text-xs"><!$><!/> <!$><!/>'),me=y("<li>"),pe=y("<div>");const _e=e=>{const t=w(()=>Array.from(be(e.techniques)));return(()=>{var n=g($e),a=n.firstChild,[i,r]=b(a.nextSibling),o=i.nextSibling,c=o.firstChild,x=c.nextSibling;return h(n,s(M,{get each(){return t()},children:l=>s(Pe,{entry:l,get isLastTechnique(){return w(()=>e.lastTechnique!=null)()&&l.id==E(e.lastTechnique)},get isNextTechnique(){return w(()=>e.nextTechnique!=null)()&&l.id==E(e.nextTechnique)}})}),i,r),h(c,()=>L("donations.question")),h(x,()=>L("donations.action")),C(l=>{var u=I("overflow-y-scroll grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 shadow-lg m-0 bg-white",e.class),v=U("/donations");return u!==l.e&&S(n,l.e=u),v!==l.t&&T(o,"href",l.t=v),l},{e:void 0,t:void 0}),n})()},Pe=e=>{const[t,n]=_();return j(()=>{if(e.isNextTechnique){const a=t();a&&a.scrollIntoView?.({block:"end",inline:"start",behavior:"smooth"})}}),s(Ce,{ref:n,get id(){return e.entry.id},get class(){return I(e.isLastTechnique&&"bg-primary-lightest outline-primary outline-4 -outline-offset-4")},get ariaCurrent(){return e.isLastTechnique},get children(){return[w(()=>w(()=>!!e.isNextTechnique)()&&(()=>{var a=g(we),i=a.firstChild,[r,o]=b(i.nextSibling),c=r.nextSibling,x=c.nextSibling,[l,u]=b(x.nextSibling);return h(a,s(ve,{class:"fill-current scale-75"}),r,o),h(a,()=>L("reader.upcoming-technique"),l,u),a})()),s(k,{get field(){return e.entry.execution},class:"text-sm h-6"}),s(k,{get field(){return e.entry.attack},class:"text-sm h-6 z-10"}),s(k,{get field(){return e.entry.defence},class:"text-xl h-8"}),s(k,{get field(){return e.entry.direction},class:"text-sm h-6"})]}})},Ce=e=>(()=>{var t=g(me),n=e.ref;return typeof n=="function"?O(n,t):e.ref=t,h(t,()=>e.children),C(a=>{var i=e.id,r=I(e.class,"border-primary-light border p-2 pt-4 rounded snap-mandatory","snap-start","relative","overflow-visible","list-none","h-32"),o=e.ariaCurrent,c=e.noListItem?"presentation":void 0;return i!==a.e&&T(t,"id",a.e=i),r!==a.t&&S(t,a.t=r),o!==a.a&&T(t,"aria-current",a.a=o),c!==a.o&&T(t,"role",a.o=c),a},{e:void 0,t:void 0,a:void 0,o:void 0}),t})(),k=e=>(()=>{var t=g(pe);return h(t,()=>e.field.value!==R&&e.field.value),C(()=>S(t,I(e.field.relevant?"text-black font-bold":"text-secondary",e.class))),t})(),Se=console.warn.bind(console);async function ke(e){return qe(e,async t=>{for(let i=0;i<2;i++)try{const r=new URL(t,window.location.href);return await(await fetch(r)).arrayBuffer()}catch(r){Se("Retrying after ",r)}const n=new URL(t,window.location.href);return await(await fetch(n)).arrayBuffer()})}async function qe(e,t){const n=Object.entries(e),a=await Promise.all(n.map(async([i,r])=>[i,await t(r)]));return Object.fromEntries(a)}let z=null;async function Te(e,t){if(z==null)throw new Error("No SpeechPack loaded");await ee(z[e],{abortSignal:t})}async function Ie(e){z=await ke(e)}function Ne(e,t){return F(e,t).map(a=>e[a])}class Ae{constructor(){this.lastTechnique=void 0,this.abortController=new AbortController}async playTechnique(t){await this.playFiles(Ne(t,this.lastTechnique)),this.abortController.signal.aborted||(this.lastTechnique=t)}async playFiles(t){this.abortController.abort();const n=new AbortController;this.abortController=n;for(const a of t){if(n.signal.aborted)return;await Te(a,n.signal)}}async stop(){this.abortController.abort()}}class Le{constructor(t,n={}){this.speechPackPlayer=new Ae,this.abortController=new AbortController,this.techniques=t,this.options=n,this.nextIndex=0,this.lastIndex=-1,this.autoPlayEnabled=!1,this.options.onUpdateNextTechnique?.(this.techniques[this.nextIndex])}async play(){this.abortController.abort(),this.abortController=new AbortController,this.options.onStart?.();try{await this._play()}finally{this.options.onStop?.()}}async _play(){await this.playNext(),this.autoPlayEnabled&&this.techniques[this.nextIndex]!=null&&(await this.options.waitSeconds?.(20,this.abortController.signal),this.autoPlayEnabled&&await this._play())}async playNext(){this.updateLastFromNext();const t=this.getNextTechnique();t!=null&&(await this.speechPackPlayer.playTechnique(t),await this.skipNext())}updateLastFromNext(){this.lastIndex=this.nextIndex,this.options.onUpdateLastTechnique?.(this.techniques[this.lastIndex])}getNextTechnique(){return this.techniques[this.nextIndex]}async stop(){await this.speechPackPlayer.stop(),this.setAutoPlay(!1),this.abortController.abort()}setAutoPlay(t){this.autoPlayEnabled=t,this.options.onAutoPlay?.(t)}async skipNext(){this.nextIndex++,this.options.onUpdateNextTechnique?.(this.techniques[this.nextIndex])}async skipPrevious(){this.nextIndex--,this.options.onUpdateNextTechnique?.(this.techniques[this.nextIndex])}destroy(){}}function Ee(e,t,n){const[a]=B(async()=>(await Ie(e()),!0)),[i,r]=_(!1),[o,c]=_(!1),[x,l]=_(null),[u,v]=_(null),d=w(()=>{const f=new Le(t(),{onStart:()=>c(!0),onStop:()=>c(!1),onAutoPlay:r,onUpdateNextTechnique:$=>v($),onUpdateLastTechnique:$=>l($),waitSeconds:n});return W(()=>f.destroy()),f});return{autoPlay:i,setAutoPlay(f){d().setAutoPlay(f)},playing:o,playerLoaded:a,lastTechnique:x,nextTechnique:u,async play(){await d().play()},async stop(){await d().stop()},async skipPrevious(){await d().skipPrevious()},async skipNext(){await d().skipNext()}}}var ze=y('<button><!$><!/><div class="grid grid-cols-3 w-24 gap-1 h-6">'),Me=y("<div>");const q=["slow","normal","fast"],Re=e=>{const{buttonClasses:t,iconClasses:n}=X(()=>e),a=w(()=>q.indexOf(e.value));function i(){const r=(a()+1)%q.length;e.onChange(q[r])}return(()=>{var r=g(ze),o=r.firstChild,[c,x]=b(o.nextSibling),l=c.nextSibling;return r.$$click=i,h(r,s(ge,{get class(){return n()}}),c,x),h(l,s(M,{each:q,children:(u,v)=>(()=>{var d=g(Me);return C(()=>S(d,a()<v()?"border-primary border":"bg-primary border-primary-dark border-1")),d})()})),C(u=>{var v=t(),d=e.disabled;return v!==u.e&&S(r,u.e=v),d!==u.t&&J(r,"disabled",u.t=d),u},{e:void 0,t:void 0}),m(),r})()};G(["click"]);var Be=y('<div class="h-full flex flex-col gap-4">'),Fe=y('<div class="grid grid-cols-4 gap-4"><!$><!/><!$><!/><!$><!/>'),Ue=y('<div class="grid grid-cols-2 gap-4"><!$><!/><!$><!/><!$><!/>'),Ve=y('<div class="h-8 w-full flex">');const De=Q(()=>Y(async()=>{const{YoutubePlayer:e}=await import("./YoutubePlayer.CacvYtOJ.js");return{YoutubePlayer:e}},__vite__mapDeps([0,1,2,3,4,5,6,7])).then(({YoutubePlayer:e})=>({default:e}))),Je=e=>{const t=V(e.dojoInfo.id),[n]=B(t.load,{initialValue:[]}),[a,i]=_(),{lastTechnique:r,nextTechnique:o,skipNext:c,skipPrevious:x,playerLoaded:l,stop:u,play:v,playing:d,setAutoPlay:f,autoPlay:$}=Ee(()=>e.speechPack,n,async(p,N)=>{await a()?.animateDelay(p,N)});return(()=>{var p=g(Be);return h(p,s(K,{fallback:"Loading",get children(){return[s(He,{get playing(){return d()},onClickPlay:async()=>{await v()},onClickStop:async()=>{f(!1),await u()},onClickNext:()=>c(),onClickPrevious:()=>x(),get ready(){return l()},onClickAutoPlay:()=>f(!$()),get autoPlayEnabled(){return $()},get youtube(){return Ye(r()?.metadata?.youtube)}}),s(te,{setDelayControl:i,get disabled(){return!$()}}),s(_e,{class:"flex-1",get techniques(){return n()},get lastTechnique(){return r()},get nextTechnique(){return o()}})]}})),p})()},He=e=>{const[t,n]=_("normal"),a=D(H);return[(()=>{var i=g(Fe),r=i.firstChild,[o,c]=b(r.nextSibling),x=o.nextSibling,[l,u]=b(x.nextSibling),v=l.nextSibling,[d,f]=b(v.nextSibling);return h(i,s(A,{label:"Previous",hideLabel:!0,size:"large",icon:ce,get disabled(){return!e.ready},get onClick(){return e.onClickPrevious}}),o,c),h(i,s(A,{class:"col-span-2",get disabled(){return!e.ready},size:"large",onClick:()=>e.playing?e.onClickStop():e.onClickPlay(),get label(){return e.playing?"Stop":"Play"},hideLabel:!0,get icon(){return e.playing?ie:ae}}),l,u),h(i,s(A,{label:"Next",hideLabel:!0,size:"large",icon:se,get disabled(){return!e.ready},get onClick(){return e.onClickNext}}),d,f),i})(),(()=>{var i=g(Ue),r=i.firstChild,[o,c]=b(r.nextSibling),x=o.nextSibling,[l,u]=b(x.nextSibling),v=l.nextSibling,[d,f]=b(v.nextSibling);return h(i,s(Z,{size:"small",icon:de,label:"Autoplay",get value(){return e.autoPlayEnabled},get onChange(){return e.onClickAutoPlay},get disabled(){return!e.ready}}),o,c),h(i,(()=>{var $=w(()=>!!a());return()=>$()&&(()=>{var p=g(Ve);return h(p,s(M,{get each(){return e.youtube},children:N=>s(De,{class:"flex-1",link:N})})),p})()})(),l,u),h(i,s(Re,{class:"hidden",size:"small",get disabled(){return!e.autoPlayEnabled&&!e.ready},get value(){return t()},onChange:n}),d,f),i})()]};function Ye(e){return Array.isArray(e)?e:e?[e]:[]}export{ie as I,Je as R};

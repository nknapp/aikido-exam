import{d as Y,c as T,a as A,g as D,b as L,i as l,e as z,f as G,h as g,j as Q,r as j,s as p,t as J,o as F,u as X,k as N}from"./web.Br_rKyYi.js";import{r as Z,b as q}from"./resolveExamTables.B3h32TL0.js";import{l as ee}from"./adapter.D3DoqAO4.js";import{c as te}from"./isReady.BL8lxnTB.js";import{S as R}from"./SimpleButton.BZcaYVZn.js";import"./preload-helper.DyxLmbb3.js";var ie=J('<div><h2></h2><p><a target=_blank></a></p><div class="relative flex flex-col gap-2"><div class="overflow-y-scroll h-96"><!$><!/><!$><!/><table><thead><tr><th>Execution</th><th>Attack</th><th>Defence</th><th>Direction</th><th>Video</th><th>dirty</th></tr></thead><tbody></tbody></table></div><div>'),ae=J("<tr><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2></td><td class=p-2>"),de=J('<div class="border p-2 gap-2 flex flex-col"><div class="grid gap-2 grid-cols-3 items-center"><label>ID:</label><div class=col-span-2></div><label>Name:</label><div class=col-span-2></div><label>Start (Press "S" to use current time):</label><input class="w-16 border p-2"type=text min=0><input type=range min=0><label>End (Press "E" to use current time):</label><input class="w-16 border p-2"type=text min=0><input type=range min=0></div><div class=flex-1>');const ue=e=>{const[s,c]=T(null),[o,$]=T(JSON.parse(localStorage.getItem(`videoPack-${e.videoPack.name}`)??"{}"));A(()=>{localStorage.setItem(`videoPack-${e.videoPack.name}`,JSON.stringify(o()))});const d=Z([e.videoPack.videos],(a,r)=>({...a,videos:r})).flatMap(({videos:a,...r})=>a.map(t=>({...r,video:t})));function x(a){$(r=>({...r,[a.video.id]:a}))}function w(a){c(o()[a.video.id]??a)}async function C(){const a=d.map(n=>o()[n.video.id]??n),r=q(a,(n,S)=>S?[...S,n.video]:[n.video]),t={...e.videoPack,videos:r};await navigator.clipboard.writeText(JSON.stringify(t,null,2)),alert("Copied to clipboard")}return(()=>{var a=D(ie),r=a.firstChild,t=r.nextSibling,n=t.firstChild,S=t.nextSibling,v=S.firstChild,V=v.firstChild,[_,O]=L(V.nextSibling),m=_.nextSibling,[u,B]=L(m.nextSibling),f=u.nextSibling,y=f.firstChild,E=y.nextSibling,P=v.nextSibling;return l(r,()=>e.videoPack.name),l(n,()=>e.videoPack.source),l(v,z(R,{label:"Clear all",onClick:()=>$({})}),_,O),l(v,z(R,{label:"Export",onClick:C}),u,B),l(E,()=>d.map((i,I)=>(()=>{var b=D(ae),h=b.firstChild,k=h.nextSibling,K=k.nextSibling,M=K.nextSibling,H=M.nextSibling,W=H.nextSibling;return b.$$click=()=>w(o()[i.video.id]??i),l(h,()=>i.execution),l(k,()=>i.attack),l(K,()=>i.defence),l(M,()=>i.direction),l(H,()=>i.video.title),l(W,()=>o()[i.video.id]!=null?"x":""),g(()=>Q(b,te(s()?.video.id===i.video.id?"bg-primary-light":I%2===0&&"bg-secondary-lightest","cursor-pointer"))),j(),b})())),l(P,(()=>{var i=G(()=>!!s());return()=>i()&&z(ne,{get video(){return s()},onChange:x})})()),g(()=>p(n,"href",e.videoPack.source)),a})()},ne=e=>{const[s,c]=T(0),[o,$]=T(e.video.video.durationSeconds);let d=null,x=null;async function w(t){const n=document.createElement("div");t.append(n),d=await ee(n),x=new ResizeObserver(()=>{d?.setSize(t.clientWidth,t.clientHeight)}),x.observe(t),await d?.loadVideoById(e.video.video.videoId,s(),o()),await d?.playVideo()}A(()=>{c(e.video.video.startSeconds??0),$(e.video.video.endSeconds??e.video.video.durationSeconds)});async function C(){await d?.loadVideoById(e.video.video.videoId,s(),o()),await d?.playVideo(),e.onChange({...e.video,video:{...e.video.video,startSeconds:s(),endSeconds:o()}})}F(()=>{d?.destroy(),x?.disconnect()}),U("KeyS",async()=>{d&&c(await d.getCurrentTime())}),U("KeyE",async()=>{d&&$(await d.getCurrentTime())}),A(()=>{e.video.video;const t=e.video.video;d?.loadVideoById(t.videoId,t.startSeconds,t.endSeconds)});function a(t){c(Number(t.target.value)),C()}function r(t){$(Number(t.target.value)),C()}return(()=>{var t=D(de),n=t.firstChild,S=n.firstChild,v=S.nextSibling,V=v.nextSibling,_=V.nextSibling,O=_.nextSibling,m=O.nextSibling,u=m.nextSibling,B=u.nextSibling,f=B.nextSibling,y=f.nextSibling,E=n.nextSibling;l(v,()=>e.video.video.videoId),l(_,()=>e.video.video.title),m.$$input=a,u.$$input=a,f.$$input=r,y.$$input=r;var P=w;return typeof P=="function"?X(P,E):w=E,g(i=>{var I=e.video.video.durationSeconds,b=e.video.video.durationSeconds,h=e.video.video.durationSeconds,k=e.video?.video.durationSeconds;return I!==i.e&&p(m,"max",i.e=I),b!==i.t&&p(u,"max",i.t=b),h!==i.a&&p(f,"max",i.a=h),k!==i.o&&p(y,"max",i.o=k),i},{e:void 0,t:void 0,a:void 0,o:void 0}),g(()=>N(m,"value",s())),g(()=>N(u,"value",s())),g(()=>N(f,"value",o())),g(()=>N(y,"value",o())),j(),t})()};function U(e,s){const c=o=>{o.code===e&&s()};window.addEventListener("keydown",c),F(()=>window.removeEventListener("keydown",c))}Y(["click","input"]);export{ue as VideoPackEditor};
